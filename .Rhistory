homolog.animals<-master.table%>%filter(.,homology_id == h) %>% select(.,animal)%>%unique()
if (nrow(homolog.animals == 1)){
mrca<-which(phy$tip.label == homolog.animals$animal)
}
else{
mrca <-getMRCA(phy,as.character(homolog.animals$animal))
}
#h.repeat<-rep(h,nrow(homolog.animals))
bind.df<-cbind(h,mrca)
result<-rbind(result,bind.df)
}
hhomolog.animals
homolog.animals
nrow(homolog.animals)
mrca <-getMRCA(phy,as.character(homolog.animals$animal))
mrca
h
bind.df<-cbind(h,mrca)
bind
bind.df
result<-rbind(result,bind.df)
result
#initialize
result<-data.frame()
#having trouble reading in a text file...
tree_text = "(Mnemiopsis_leidyi,(Amphimedon_queenslandica,(Trichoplax_adhaerens,(Nematostella_vectensis,((Drosophila_melanogaster,(Lottia_gigantea,(Capitella_telata,Helobdella_robusta))),(Strongylocentrotus_purpuratus,(Danio_rerio,(Homo_sapiens,Taeniopygia_guttata))))))));"
phy = read.tree(text=tree_text)
plot(phy)
tip.label<-phy$tip.label
#create a df of homology_id - animal
homolog.list<-unique(master.table$homology_id)
homolog.list<-homolog.list[!is.na(homolog.list)]
for (h in homolog.list){
homolog.animals<-master.table%>%filter(.,homology_id == h) %>% select(.,animal)%>%unique()
if (nrow(homolog.animals == 1)){
mrca<-which(phy$tip.label == homolog.animals$animal)
print(mrca,"one")
}
else{
mrca <-getMRCA(phy,as.character(homolog.animals$animal))
print(mcra,homolog.animals)
}
#h.repeat<-rep(h,nrow(homolog.animals))
bind.df<-cbind(h,mrca)
print(bind.df)
result<-rbind(result,bind.df)
}
#initialize
result<-data.frame()
#having trouble reading in a text file...
tree_text = "(Mnemiopsis_leidyi,(Amphimedon_queenslandica,(Trichoplax_adhaerens,(Nematostella_vectensis,((Drosophila_melanogaster,(Lottia_gigantea,(Capitella_telata,Helobdella_robusta))),(Strongylocentrotus_purpuratus,(Danio_rerio,(Homo_sapiens,Taeniopygia_guttata))))))));"
phy = read.tree(text=tree_text)
plot(phy)
tip.label<-phy$tip.label
#create a df of homology_id - animal
homolog.list<-unique(master.table$homology_id)
homolog.list<-homolog.list[!is.na(homolog.list)]
for (h in homolog.list){
homolog.animals<-master.table%>%filter(.,homology_id == h) %>% select(.,animal)%>%unique()
if (nrow(homolog.animals == 1)){
mrca<-which(phy$tip.label == homolog.animals$animal)
print("one")
}
else{
mrca <-getMRCA(phy,as.character(homolog.animals$animal))
print(homolog.animals)
}
#h.repeat<-rep(h,nrow(homolog.animals))
bind.df<-cbind(h,mrca)
print(bind.df)
result<-rbind(result,bind.df)
}
#initialize
result<-data.frame()
#having trouble reading in a text file...
tree_text = "(Mnemiopsis_leidyi,(Amphimedon_queenslandica,(Trichoplax_adhaerens,(Nematostella_vectensis,((Drosophila_melanogaster,(Lottia_gigantea,(Capitella_telata,Helobdella_robusta))),(Strongylocentrotus_purpuratus,(Danio_rerio,(Homo_sapiens,Taeniopygia_guttata))))))));"
phy = read.tree(text=tree_text)
plot(phy)
tip.label<-phy$tip.label
#create a df of homology_id - animal
homolog.list<-unique(master.table$homology_id)
homolog.list<-homolog.list[!is.na(homolog.list)]
for (h in homolog.list){
homolog.animals<-master.table%>%filter(.,homology_id == h) %>% select(.,animal)%>%unique()
if (nrow(homolog.animals == 1)){
mrca<-which(phy$tip.label == homolog.animals$animal)
print("one")
}
else{
mrca <-getMRCA(phy,as.character(homolog.animals$animal))
print("multiple")
}
#h.repeat<-rep(h,nrow(homolog.animals))
bind.df<-cbind(h,mrca)
print(bind.df)
result<-rbind(result,bind.df)
}
result
#initialize
result<-data.frame()
#having trouble reading in a text file...
tree_text = "(Mnemiopsis_leidyi,(Amphimedon_queenslandica,(Trichoplax_adhaerens,(Nematostella_vectensis,((Drosophila_melanogaster,(Lottia_gigantea,(Capitella_telata,Helobdella_robusta))),(Strongylocentrotus_purpuratus,(Danio_rerio,(Homo_sapiens,Taeniopygia_guttata))))))));"
phy = read.tree(text=tree_text)
plot(phy)
tip.label<-phy$tip.label
#create a df of homology_id - animal
homolog.list<-unique(master.table$homology_id)
homolog.list<-homolog.list[!is.na(homolog.list)]
for (h in homolog.list){
homolog.animals<-master.table%>%filter(.,homology_id == h) %>% select(.,animal)%>%unique()
if (nrow(homolog.animals == 1)){
mrca<-which(phy$tip.label == homolog.animals$animal)
print("one")
}
else{
mrca <-getMRCA(phy,as.character(homolog.animals$animal))
print("multiple")
}
#h.repeat<-rep(h,nrow(homolog.animals))
bind.df<-cbind(h,mrca)
print("rbind")
print(bind.df)
result<-rbind(result,bind.df)
}
h<-2523
homolog.animals<-master.table%>%filter(.,homology_id == h) %>% select(.,animal)%>%unique()
homolog.animals
nrwo(homolog.animals)
nrow(homolog.animals)
#initialize
result<-data.frame()
#having trouble reading in a text file...
tree_text = "(Mnemiopsis_leidyi,(Amphimedon_queenslandica,(Trichoplax_adhaerens,(Nematostella_vectensis,((Drosophila_melanogaster,(Lottia_gigantea,(Capitella_telata,Helobdella_robusta))),(Strongylocentrotus_purpuratus,(Danio_rerio,(Homo_sapiens,Taeniopygia_guttata))))))));"
phy = read.tree(text=tree_text)
plot(phy)
tip.label<-phy$tip.label
#create a df of homology_id - animal
homolog.list<-unique(master.table$homology_id)
homolog.list<-homolog.list[!is.na(homolog.list)]
for (h in homolog.list){
homolog.animals<-master.table%>%filter(.,homology_id == h) %>% select(.,animal)%>%unique()
if (nrow(homolog.animals == 1)){
mrca<-which(phy$tip.label == homolog.animals$animal)
print("one")
next
}
else{
mrca <-getMRCA(phy,as.character(homolog.animals$animal))
print("multiple")
}
#h.repeat<-rep(h,nrow(homolog.animals))
bind.df<-cbind(h,mrca)
print("rbind")
print(bind.df)
result<-rbind(result,bind.df)
}
#singletons??! - 1 homology_id <-> animal, multiple genes (paralogs)
View(result)
result
#initialize
result<-data.frame()
#having trouble reading in a text file...
tree_text = "(Mnemiopsis_leidyi,(Amphimedon_queenslandica,(Trichoplax_adhaerens,(Nematostella_vectensis,((Drosophila_melanogaster,(Lottia_gigantea,(Capitella_telata,Helobdella_robusta))),(Strongylocentrotus_purpuratus,(Danio_rerio,(Homo_sapiens,Taeniopygia_guttata))))))));"
phy = read.tree(text=tree_text)
plot(phy)
tip.label<-phy$tip.label
#create a df of homology_id - animal
homolog.list<-unique(master.table$homology_id)
homolog.list<-homolog.list[!is.na(homolog.list)]
for (h in homolog.list){
homolog.animals<-master.table%>%filter(.,homology_id == h) %>% select(.,animal)%>%unique()
if (nrow(homolog.animals == 1)){
mrca<-which(phy$tip.label == homolog.animals$animal)
print("one")
}
if (nrow(homolog.animals > 1){
#initialize
result<-data.frame()
#having trouble reading in a text file...
tree_text = "(Mnemiopsis_leidyi,(Amphimedon_queenslandica,(Trichoplax_adhaerens,(Nematostella_vectensis,((Drosophila_melanogaster,(Lottia_gigantea,(Capitella_telata,Helobdella_robusta))),(Strongylocentrotus_purpuratus,(Danio_rerio,(Homo_sapiens,Taeniopygia_guttata))))))));"
phy = read.tree(text=tree_text)
plot(phy)
tip.label<-phy$tip.label
#create a df of homology_id - animal
homolog.list<-unique(master.table$homology_id)
homolog.list<-homolog.list[!is.na(homolog.list)]
for (h in homolog.list){
homolog.animals<-master.table%>%filter(.,homology_id == h) %>% select(.,animal)%>%unique()
if (nrow(homolog.animals == 1)){
mrca<-which(phy$tip.label == homolog.animals$animal)
print("one")
}
if (nrow(homolog.animals > 1)){
mrca <-getMRCA(phy,as.character(homolog.animals$animal))
print("multiple")
}
#h.repeat<-rep(h,nrow(homolog.animals))
bind.df<-cbind(h,mrca)
print("rbind")
print(bind.df)
result<-rbind(result,bind.df)
}
result
#mixing up the columns or rows will not affect overall clustering pattern (i.e. all clustering)
#make a data frame with the same proportion of 1's and 0's in random order
dim(contingency)
n_entries<-ncol(contingency)*nrow(contingency)
proportion_1s<-sum(contingency)/n_entries
proportion_0s<-1-proportion_1s
random.matrix<-c(rep("1",proportion_1s*n_entries),rep("0",proportion_0s*n_entries))%>%sample(.,n_entries)%>%matrix(.,ncol=ncol(contingency),nrow=nrow(contingency))%>%as.data.frame()
rownames(random.matrix)<-row.names(contingency)
colnames(random.matrix)<-colnames(contingency)
#cluster
rand.dist.matrix<-daisy(random.matrix,metric="gower",stand=FALSE)
rand.cross.clust<-cc_crossclustering(rand.dist.matrix,out=FALSE)
#initialize
result<-data.frame()
#having trouble reading in a text file...
tree_text = "(Mnemiopsis_leidyi,(Amphimedon_queenslandica,(Trichoplax_adhaerens,(Nematostella_vectensis,((Drosophila_melanogaster,(Lottia_gigantea,(Capitella_telata,Helobdella_robusta))),(Strongylocentrotus_purpuratus,(Danio_rerio,(Homo_sapiens,Taeniopygia_guttata))))))));"
phy = read.tree(text=tree_text)
plot(phy)
tip.label<-phy$tip.label
#create a df of homology_id - animal
homolog.list<-unique(master.table$homology_id)
homolog.list<-homolog.list[!is.na(homolog.list)]
for (h in homolog.list){
homolog.animals<-master.table%>%filter(.,homology_id == h) %>% select(.,animal)%>%unique()
if (nrow(homolog.animals == 1)){
mrca<-which(phy$tip.label == homolog.animals$animal)
print("one")
}
if (nrow(homolog.animals > 1)){
mrca <-getMRCA(phy,as.character(homolog.animals$animal))
print("multiple")
}
#h.repeat<-rep(h,nrow(homolog.animals))
bind.df<-cbind(h,mrca)
print("bind.df")
print(bind.df)
result<-rbind(result,bind.df)
}
View(homolog.list)
View(master.table)
h
homolog.animals<-master.table%>%filter(.,homology_id == h) %>% select(.,animal)%>%unique()
homolog.animals
#initialize
result<-data.frame()
#having trouble reading in a text file...
tree_text = "(Mnemiopsis_leidyi,(Amphimedon_queenslandica,(Trichoplax_adhaerens,(Nematostella_vectensis,((Drosophila_melanogaster,(Lottia_gigantea,(Capitella_telata,Helobdella_robusta))),(Strongylocentrotus_purpuratus,(Danio_rerio,(Homo_sapiens,Taeniopygia_guttata))))))));"
phy = read.tree(text=tree_text)
plot(phy)
tip.label<-phy$tip.label
#create a df of homology_id - animal
homolog.list<-unique(master.table$homology_id)
homolog.list<-homolog.list[!is.na(homolog.list)]
for (h in homolog.list){
homolog.animals<-master.table%>%filter(.,homology_id == h) %>% select(.,animal)%>%unique()
if (nrow(homolog.animals) == 1){
mrca<-which(phy$tip.label == homolog.animals$animal)
print("one")
}
if (nrow(homolog.animals > 1)){
mrca <-getMRCA(phy,as.character(homolog.animals$animal))
print("multiple")
}
#h.repeat<-rep(h,nrow(homolog.animals))
bind.df<-cbind(h,mrca)
print("bind.df")
print(bind.df)
result<-rbind(result,bind.df)
}
#initialize
result<-data.frame()
#having trouble reading in a text file...
tree_text = "(Mnemiopsis_leidyi,(Amphimedon_queenslandica,(Trichoplax_adhaerens,(Nematostella_vectensis,((Drosophila_melanogaster,(Lottia_gigantea,(Capitella_telata,Helobdella_robusta))),(Strongylocentrotus_purpuratus,(Danio_rerio,(Homo_sapiens,Taeniopygia_guttata))))))));"
phy = read.tree(text=tree_text)
plot(phy)
tip.label<-phy$tip.label
#create a df of homology_id - animal
homolog.list<-unique(master.table$homology_id)
homolog.list<-homolog.list[!is.na(homolog.list)]
for (h in homolog.list){
homolog.animals<-master.table%>%filter(.,homology_id == h) %>% select(.,animal)%>%unique()
if (nrow(homolog.animals) == 1){
mrca<-which(phy$tip.label == homolog.animals$animal)
print("one")
}
if (nrow(homolog.animals) > 1){
mrca <-getMRCA(phy,as.character(homolog.animals$animal))
print("multiple")
}
#h.repeat<-rep(h,nrow(homolog.animals))
bind.df<-cbind(h,mrca)
print("bind.df")
print(bind.df)
result<-rbind(result,bind.df)
}
#singletons??! - 1 homology_id <-> animal, multiple genes (paralogs)
rseult
View(result)
nrow(homolog.list)
homolog.list
count(homolog.list)
result<-""
result
result<-
0
result
#initialize
result<-data.frame()
#having trouble reading in a text file...
tree_text = "(Mnemiopsis_leidyi,(Amphimedon_queenslandica,(Trichoplax_adhaerens,(Nematostella_vectensis,((Drosophila_melanogaster,(Lottia_gigantea,(Capitella_telata,Helobdella_robusta))),(Strongylocentrotus_purpuratus,(Danio_rerio,(Homo_sapiens,Taeniopygia_guttata))))))));"
phy = read.tree(text=tree_text)
plot(phy)
tip.label<-phy$tip.label
#create a df of homology_id - animal
homolog.list<-unique(master.table$homology_id)
homolog.list<-homolog.list[!is.na(homolog.list)]
for (h in homolog.list){
homolog.animals<-master.table%>%filter(.,homology_id == h) %>% select(.,animal)%>%unique()
if (nrow(homolog.animals) == 1){
mrca<-which(phy$tip.label == homolog.animals$animal)
}
if (nrow(homolog.animals) > 1){
mrca <-getMRCA(phy,as.character(homolog.animals$animal))
}
#h.repeat<-rep(h,nrow(homolog.animals))
bind.df<-cbind(h,mrca)
print("bind.df")
result<-rbind(result,bind.df)
}
#singletons??! - 1 homology_id <-> animal, multiple genes (paralogs)
View(result)
#initialize
result<-data.frame()
#having trouble reading in a text file...
tree_text = "(Mnemiopsis_leidyi,(Amphimedon_queenslandica,(Trichoplax_adhaerens,(Nematostella_vectensis,((Drosophila_melanogaster,(Lottia_gigantea,(Capitella_telata,Helobdella_robusta))),(Strongylocentrotus_purpuratus,(Danio_rerio,(Homo_sapiens,Taeniopygia_guttata))))))));"
phy = read.tree(text=tree_text)
plot(phy)
tip.label<-phy$tip.label
#create a df of homology_id - animal
homolog.list<-unique(master.table$homology_id)
#homolog.list<-homolog.list[!is.na(homolog.list)]
for (h in homolog.list){
homolog.animals<-master.table%>%filter(.,homology_id == h) %>% select(.,animal)%>%unique()
if (nrow(homolog.animals) == 1){
mrca<-which(phy$tip.label == homolog.animals$animal)
}
if (nrow(homolog.animals) > 1){
mrca <-getMRCA(phy,as.character(homolog.animals$animal))
}
#h.repeat<-rep(h,nrow(homolog.animals))
bind.df<-cbind(h,mrca)
print("bind.df")
result<-rbind(result,bind.df)
}
#singletons??! - 1 homology_id <-> animal, multiple genes (paralogs)
View(result)
#initialize
mrca.df<-data.frame()
#having trouble reading in a text file...
tree_text = "(Mnemiopsis_leidyi,(Amphimedon_queenslandica,(Trichoplax_adhaerens,(Nematostella_vectensis,((Drosophila_melanogaster,(Lottia_gigantea,(Capitella_telata,Helobdella_robusta))),(Strongylocentrotus_purpuratus,(Danio_rerio,(Homo_sapiens,Taeniopygia_guttata))))))));"
phy = read.tree(text=tree_text)
plot(phy)
tip.label<-phy$tip.label
#create a list of unique homology_ids
homolog.list<-unique(master.table$homology_id)
homolog.list<-homolog.list[!is.na(homolog.list)]
#loop through homology_ids and find MRCA for each
for (h in homolog.list){
homolog.animals<-master.table%>%filter(.,homology_id == h) %>% select(.,animal)%>%unique()
if (nrow(homolog.animals) == 1){
mrca<-which(phy$tip.label == homolog.animals$animal)
}
if (nrow(homolog.animals) > 1){
mrca <-getMRCA(phy,as.character(homolog.animals$animal))
}
#h.repeat<-rep(h,nrow(homolog.animals))
bind.df<-cbind(h,mrca)
mrca.df<-rbind(mrca.df,bind.df)
}
#singletons??! - 1 homology_id <-> animal, multiple genes (paralogs)
h<-3202
homolog.animals<-master.table%>%filter(.,homology_id == h) %>% select(.,animal)%>%unique()
homolog.animals
h<-88
homolog.animals<-master.table%>%filter(.,homology_id == h) %>% select(.,animal)%>%unique()
homolog.animals
getMRCA(phy,c("Danio_rerio","Drosophila_melanogaster","Homo_sapiens","Strongylocentrotus_purpuratus","Taeniopygia_guttata"))
h<-89
homolog.animals<-master.table%>%filter(.,homology_id == h) %>% select(.,animal)%>%unique()
homolog.animals
View(mrca.df)
bind.df<-cbind(homology_id=h,mrca)
bind.df
#initialize
mrca.df<-data.frame()
#phylogeny
tree_text = "(Mnemiopsis_leidyi,(Amphimedon_queenslandica,(Trichoplax_adhaerens,(Nematostella_vectensis,((Drosophila_melanogaster,(Lottia_gigantea,(Capitella_telata,Helobdella_robusta))),(Strongylocentrotus_purpuratus,(Danio_rerio,(Homo_sapiens,Taeniopygia_guttata))))))));"
phy = read.tree(text=tree_text)
plot(phy)
#find MRCA for each homology_id
#create a list of unique homology_ids; do not include NAs
homolog.list<-unique(master.table$homology_id)
homolog.list<-homolog.list[!is.na(homolog.list)]
#loop through homology_ids and find MRCA for each
for (h in homolog.list){
homolog.animals<-master.table%>%filter(.,homology_id == h) %>% select(.,animal)%>%unique()
if (nrow(homolog.animals) == 1){
mrca<-which(phy$tip.label == homolog.animals$animal)
}
if (nrow(homolog.animals) > 1){
mrca <-getMRCA(phy,as.character(homolog.animals$animal))
}
bind.df<-cbind(homology_id=h,mrca)
mrca.df<-rbind(mrca.df,bind.df)
}
#initialize
mrca.df<-data.frame()
#phylogeny
tree_text = "(Mnemiopsis_leidyi,(Amphimedon_queenslandica,(Trichoplax_adhaerens,(Nematostella_vectensis,((Drosophila_melanogaster,(Lottia_gigantea,(Capitella_telata,Helobdella_robusta))),(Strongylocentrotus_purpuratus,(Danio_rerio,(Homo_sapiens,Taeniopygia_guttata))))))));"
phy = read.tree(text=tree_text)
plot(phy)
#find MRCA for each homology_id
#create a list of unique homology_ids; do not include NAs
homolog.list<-unique(master.table$homology_id)
homolog.list<-homolog.list[!is.na(homolog.list)]
#loop through homology_ids and find MRCA for each
for (h in homolog.list){
homolog.animals<-master.table%>%filter(.,homology_id == h) %>% select(.,animal)%>%unique()
if (nrow(homolog.animals) == 1){
mrca<-which(phy$tip.label == homolog.animals$animal)
}
if (nrow(homolog.animals) > 1){
mrca <-getMRCA(phy,as.character(homolog.animals$animal))
}
bind.df<-cbind(homology_id=h,mrca)
mrca.df<-rbind(mrca.df,bind.df)
}
new.master.table<-left_join(master.table,mrca.df, by="homology_id")
View(new.master.table)
h<-570
n<-4735
answer<-17
homolog.animals<-master.table%>%filter(.,homology_id == h) %>% select(.,animal)%>%unique()
homolog.animals
getMRCA(phy,as.character(homolog.animals$animal))
h<-n
homolog.animals<-master.table%>%filter(.,homology_id == h) %>% select(.,animal)%>%unique()
getMRCA(phy,as.character(homolog.animals$animal))
homolog.animal.df
homolog.animals
filter(new.master.table,homology_id==1005)
descendants(phy,h)
mcra.df
View(mrca.df)
phy
phy$edge
descendents(phy,22)
# Get all the nodes, internal and external, that are within Deuterostomia
descendants(phy, 22)
length(tree_text)
length(phy$tip.label)
descendants(phy,22)
descendants(phy,22) %>% select(., >=12)
descendants(phy,22) %>% select(>=12)
descendants(phy,22) >= 12
descendants(phy,22)[which <=12]
descendants(phy,22) %>%subset(<=12)
descendants(phy,22)
descendants<-descendants(phy,22)
descendants<-subset(descendants<=12)
class(descendants)
class(descendants(phy,22) )
descendants<-subset(descendants<=12)
descendants
descendants[<=12]
descendants[descendants<=12]
h<-22
tips<-descendants(phy,h)
tips<-tips[tips<=length(phy$tip.label)]
tips
which (phy$tip.label == "10")
which (phy$tip.label == 10)
View(filter(new.master.table,homology_id==22))
View(filter(new.master.table,homology_id==1005))
View(filter(new.master.table,homology_id==1005)%>%select(.,animla))
View(filter(new.master.table,homology_id==1005)%>%select(.,animal))
View(filter(new.master.table,homology_id==1005)%>%select(.,animal))%>%unique()
View(filter(new.master.table,homology_id==1005)%>%select(.,animal)%>%unique())
present<-filter(new.master.table,homology_id==1005)%>%select(.,animal)%>%unique()
present
tips
h<-1055
for (h in mrca.df$homology_id){
tips<-descendants(phy,h)
}
tips
tips<-descendants(phy,h)
tips
h<-1055
h<-1005
tips<-descendants(phy,h)
tips<-tips[tips<=length(phy$tip.label)]
tips
h
tips<-descendants(phy,h)
tips
View(mrca.df)
phy$tip.label
which(phy$tip.level ==)
