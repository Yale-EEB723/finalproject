comparison_absent<-anti_join(reference.table.scaffold,comp.table.scaffold,by="homology_id")
}
}
comparison_absent<-anti_join(analysis.table.reference,analysis.table.comparison,by="homology_id")
View(comparison_absent)
View(ref.scaffold)
reference="Homo_sapiens"
comparison="Danio_rerio"
analysis.table.reference<-filter(cluster.master.table,animal==reference)
analysis.table.comparison<-filter(cluster.master.table,animal==comparison)
ref.scaffold<-unique(analysis.table.reference$species_scaffold)
#list of unique scaffold ids in reference
#for each unique scaffold in the reference table
for (r in ref.scaffold){
r="1_Homo_sapiens"
#for each unique scaffold in reference
reference.table.scaffold<-analysis.table.reference%>%filter(.,species_scaffold==r)
#find cluster_id
ref.cluster_id<-unique(reference.table.scaffold$cluster_id)
ref.cluster_id<-2
#find all unique scaffolds in comparison table with that cluster_id
comp.scaffold<-analysis.table.comparison%>%filter(.,cluster_id==ref.cluster_id)
comp.scaffold<-unique(comp.scaffold$species_scaffold)
#for each unique scaffold in comparison table with that cluster_id
for (c in comp.scaffold){
c="1_Danio_rerio"
comp.table.scaffold<-analysis.table.comparison%>%filter(.,species_scaffold==c)
comparison_absent<-anti_join(reference.table.scaffold,comp.table.scaffold,by="homology_id")
}
}
comparison_absent<-anti_join(analysis.table.reference,analysis.table.comparison,by="homology_id")
View(comparison_absent)
View(reference.table.scaffold)
View(reference.table.scaffold)
View(ref.scaffold)
View(analysis.table.reference)
reference="Homo_sapiens"
comparison="Danio_rerio"
analysis.table.reference<-filter(cluster.master.table,animal==reference)
analysis.table.comparison<-filter(cluster.master.table,animal==comparison)
ref.scaffold<-unique(analysis.table.reference$species_scaffold)
#list of unique scaffold ids in reference
#for each unique scaffold in the reference table
for (r in ref.scaffold){
r="5_Homo_sapiens"
#for each unique scaffold in reference
reference.table.scaffold<-analysis.table.reference%>%filter(.,species_scaffold==r)
#find cluster_id
ref.cluster_id<-unique(reference.table.scaffold$cluster_id)
#find all unique scaffolds in comparison table with that cluster_id
comp.scaffold<-analysis.table.comparison%>%filter(.,cluster_id==ref.cluster_id)
comp.scaffold<-unique(comp.scaffold$species_scaffold)
#for each unique scaffold in comparison table with that cluster_id
for (c in comp.scaffold){
c="1_Danio_rerio"
comp.table.scaffold<-analysis.table.comparison%>%filter(.,species_scaffold==c)
comparison_absent<-anti_join(reference.table.scaffold,comp.table.scaffold,by="homology_id")
}
}
comparison_absent<-anti_join(analysis.table.reference,analysis.table.comparison,by="homology_id")
View(comparison_absent)
View(comp.scaffold)
comp.scaffold<-analysis.table.comparison%>%filter(.,cluster_id==ref.cluster_id)
View(comp.scaffold)
comp.scaffold<-unique(comp.scaffold$species_scaffold)
View(comp.scaffold)
comp.table.scaffold<-analysis.table.comparison%>%filter(.,species_scaffold==c)
View(comp.table.scaffold)
View(reference.table.scaffold)
comparison_absent<-anti_join(reference.table.scaffold,comp.table.scaffold,by="homology_id")
View(comparison_absent)
reference="Homo_sapiens"
comparison="Danio_rerio"
analysis.table.reference<-filter(cluster.master.table,animal==reference)
analysis.table.comparison<-filter(cluster.master.table,animal==comparison)
ref.scaffold<-unique(analysis.table.reference$species_scaffold)
#list of unique scaffold ids in reference
#for each unique scaffold in the reference table
for (r in ref.scaffold){
r="5_Homo_sapiens"
#for each unique scaffold in reference
reference.table.scaffold<-analysis.table.reference%>%filter(.,species_scaffold==r)
#find cluster_id
ref.cluster_id<-unique(reference.table.scaffold$cluster_id)
#find all unique scaffolds in comparison table with that cluster_id
comp.scaffold<-analysis.table.comparison%>%filter(.,cluster_id==ref.cluster_id)
comp.scaffold<-unique(comp.scaffold$species_scaffold)
#for each unique scaffold in comparison table with that cluster_id
for (c in comp.scaffold){
c="1_Danio_rerio"
comp.table.scaffold<-analysis.table.comparison%>%filter(.,species_scaffold==c)
comparison_absent<-anti_join(reference.table.scaffold,comp.table.scaffold,by="homology_id")
}
}
comparison_absent<-anti_join(analysis.table.reference,analysis.table.comparison,by="homology_id")
View(comparison_absent)
reference="Homo_sapiens"
comparison="Danio_rerio"
#subset cluster.master.table for the reference or comparison animal:
analysis.table.reference<-filter(cluster.master.table,animal==reference)
analysis.table.comparison<-filter(cluster.master.table,animal==comparison)
#list of unique scaffold ids in reference
ref.scaffold.list<-unique(analysis.table.reference$species_scaffold)
#for each unique scaffold in the reference table:
for (r in ref.scaffold.list){
#r="5_Homo_sapiens"
#subset analysis.table.ref for each scaffold
reference.table.scaffold<-analysis.table.reference%>%filter(.,species_scaffold==r)
#find cluster_id of scaffold
ref.cluster_id<-unique(reference.table.scaffold$cluster_id)
#find all unique scaffolds in comparison table with that cluster_id
comp.scaffold<-analysis.table.comparison%>%filter(.,cluster_id==ref.cluster_id)
comp.scaffold.list<-unique(comp.scaffold$species_scaffold)
#for each unique scaffold in comparison table with that cluster_id
for (c in comp.scaffold){
# c="1_Danio_rerio"
comp.table.scaffold<-analysis.table.comparison%>%filter(.,species_scaffold==c)
#find the set of genes present in refererence.table.scaffold but not comp.table.scaffold
comparison_absent<-anti_join(reference.table.scaffold,comp.table.scaffold,by="homology_id")
}
}
reference="Homo_sapiens"
comparison="Danio_rerio"
#subset cluster.master.table for the reference or comparison animal:
analysis.table.reference<-filter(cluster.master.table,animal==reference)
analysis.table.comparison<-filter(cluster.master.table,animal==comparison)
#list of unique scaffold ids in reference
ref.scaffold<-unique(analysis.table.reference$species_scaffold)
#for each unique scaffold in the reference table:
for (r in ref.scaffold){
r="5_Homo_sapiens"
#for each unique scaffold in reference
reference.table.scaffold<-analysis.table.reference%>%filter(.,species_scaffold==r)
#find cluster_id
ref.cluster_id<-unique(reference.table.scaffold$cluster_id)
#find all unique scaffolds in comparison table with that cluster_id
comp.scaffold<-analysis.table.comparison%>%filter(.,cluster_id==ref.cluster_id)
comp.scaffold<-unique(comp.scaffold$species_scaffold)
#for each unique scaffold in comparison table with that cluster_id
for (c in comp.scaffold){
c="1_Danio_rerio"
comp.table.scaffold<-analysis.table.comparison%>%filter(.,species_scaffold==c)
comparison_absent<-anti_join(reference.table.scaffold,comp.table.scaffold,by="homology_id")
}
}
#works line by line but not when looping
comparison_absent<-anti_join(analysis.table.reference,analysis.table.comparison,by="homology_id")
View(comparison_absent)
View(ref.scaffold)
View(reference.table.scaffold)
View(comp.table.scaffold)
comparison_absent<-anti_join(reference.table.scaffold,comp.table.scaffold,by="homology_id")
View(comparison_absent)
reference="Homo_sapiens"
comparison="Danio_rerio"
#subset cluster.master.table for the reference or comparison animal:
analysis.table.reference<-filter(cluster.master.table,animal==reference)
analysis.table.comparison<-filter(cluster.master.table,animal==comparison)
#list of unique scaffold ids in reference
ref.scaffold<-unique(analysis.table.reference$species_scaffold)
#for each unique scaffold in the reference table:
for (r in ref.scaffold){
r="5_Homo_sapiens"
#for each unique scaffold in reference
reference.table.scaffold<-analysis.table.reference%>%filter(.,species_scaffold==r)
#find cluster_id
ref.cluster_id<-unique(reference.table.scaffold$cluster_id)
#find all unique scaffolds in comparison table with that cluster_id
comp.scaffold<-analysis.table.comparison%>%filter(.,cluster_id==ref.cluster_id)
comp.scaffold<-unique(comp.scaffold$species_scaffold)
#for each unique scaffold in comparison table with that cluster_id
for (c in comp.scaffold){
c="1_Danio_rerio"
comp.table.scaffold<-analysis.table.comparison%>%filter(.,species_scaffold==c)
comparison_absent<-anti_join(reference.table.scaffold,comp.table.scaffold,by="homology_id")
}
}
#works line by line but not when looping
comparison_absent<-anti_join(analysis.table.reference,analysis.table.comparison,by="homology_id")
View(comparison_absent)
reference="Homo_sapiens"
comparison="Danio_rerio"
#subset cluster.master.table for the reference or comparison animal:
analysis.table.reference<-filter(cluster.master.table,animal==reference)
analysis.table.comparison<-filter(cluster.master.table,animal==comparison)
#list of unique scaffold ids in reference
ref.scaffold<-unique(analysis.table.reference$species_scaffold)
#for each unique scaffold in the reference table:
for (r in ref.scaffold){
r="5_Homo_sapiens"
#for each unique scaffold in reference
reference.table.scaffold<-analysis.table.reference%>%filter(.,species_scaffold==r)
#find cluster_id
ref.cluster_id<-unique(reference.table.scaffold$cluster_id)
#find all unique scaffolds in comparison table with that cluster_id
comp.scaffold<-analysis.table.comparison%>%filter(.,cluster_id==ref.cluster_id)
comp.scaffold<-unique(comp.scaffold$species_scaffold)
#for each unique scaffold in comparison table with that cluster_id
for (c in comp.scaffold){
c="1_Danio_rerio"
comp.table.scaffold<-analysis.table.comparison%>%filter(.,species_scaffold==c)
comparison_absent<-anti_join(reference.table.scaffold,comp.table.scaffold,by="homology_id")%>%rbind()
}
}
#works line by line but not when looping
comparison_absent<-anti_join(analysis.table.reference,analysis.table.comparison,by="homology_id")
reference="Homo_sapiens"
comparison="Danio_rerio"
#subset cluster.master.table for the reference or comparison animal:
analysis.table.reference<-filter(cluster.master.table,animal==reference)
analysis.table.comparison<-filter(cluster.master.table,animal==comparison)
#list of unique scaffold ids in reference
ref.scaffold<-unique(analysis.table.reference$species_scaffold)
#for each unique scaffold in the reference table:
for (r in ref.scaffold){
# r="5_Homo_sapiens"
#for each unique scaffold in reference
reference.table.scaffold<-analysis.table.reference%>%filter(.,species_scaffold==r)
#find cluster_id
ref.cluster_id<-unique(reference.table.scaffold$cluster_id)
#find all unique scaffolds in comparison table with that cluster_id
comp.scaffold<-analysis.table.comparison%>%filter(.,cluster_id==ref.cluster_id)
comp.scaffold<-unique(comp.scaffold$species_scaffold)
#for each unique scaffold in comparison table with that cluster_id
for (c in comp.scaffold){
#c="1_Danio_rerio"
comp.table.scaffold<-analysis.table.comparison%>%filter(.,species_scaffold==c)
comparison_absent<-anti_join(reference.table.scaffold,comp.table.scaffold,by="homology_id")%>%rbind()
}
}
#works line by line but not when looping
comparison_absent<-anti_join(analysis.table.reference,analysis.table.comparison,by="homology_id")
View(comparison_absent)
r="5_Homo_sapiens"
#for each unique scaffold in reference
reference.table.scaffold<-analysis.table.reference%>%filter(.,species_scaffold==r)
#find cluster_id
ref.cluster_id<-unique(reference.table.scaffold$cluster_id)
comp.scaffold<-analysis.table.comparison%>%filter(.,cluster_id==ref.cluster_id)
comp.scaffold<-unique(comp.scaffold$species_scaffold)
c="1_Danio_rerio"
comp.table.scaffold<-analysis.table.comparison%>%filter(.,species_scaffold==c)
comparison_absent<-anti_join(reference.table.scaffold,comp.table.scaffold,by="homology_id")%>%rbind()
View(comparison_absent)
reference="Homo_sapiens"
comparison="Danio_rerio"
#subset cluster.master.table for the reference or comparison animal:
analysis.table.reference<-filter(cluster.master.table,animal==reference)
analysis.table.comparison<-filter(cluster.master.table,animal==comparison)
#list of unique scaffold ids in reference
ref.scaffold<-unique(analysis.table.reference$species_scaffold)
#for each unique scaffold in the reference table:
for (r in ref.scaffold){
r="5_Homo_sapiens"
#for each unique scaffold in reference
reference.table.scaffold<-analysis.table.reference%>%filter(.,species_scaffold==r)
#find cluster_id
ref.cluster_id<-unique(reference.table.scaffold$cluster_id)
#find all unique scaffolds in comparison table with that cluster_id
comp.scaffold<-analysis.table.comparison%>%filter(.,cluster_id==ref.cluster_id)
comp.scaffold<-unique(comp.scaffold$species_scaffold)
#for each unique scaffold in comparison table with that cluster_id
for (c in comp.scaffold){
c="1_Danio_rerio"
comp.table.scaffold<-analysis.table.comparison%>%filter(.,species_scaffold==c)
comparison_absent<-anti_join(reference.table.scaffold,comp.table.scaffold,by="homology_id")
}
}
reference="Homo_sapiens"
comparison="Danio_rerio"
#subset cluster.master.table for the reference or comparison animal:
analysis.table.reference<-filter(cluster.master.table,animal==reference)
analysis.table.comparison<-filter(cluster.master.table,animal==comparison)
#list of unique scaffold ids in reference
ref.scaffold<-unique(analysis.table.reference$species_scaffold)
r="5_Homo_sapiens"
#for each unique scaffold in reference
reference.table.scaffold<-analysis.table.reference%>%filter(.,species_scaffold==r)
#find cluster_id
ref.cluster_id<-unique(reference.table.scaffold$cluster_id)
#find all unique scaffolds in comparison table with that cluster_id
comp.scaffold<-analysis.table.comparison%>%filter(.,cluster_id==ref.cluster_id)
comp.scaffold<-unique(comp.scaffold$species_scaffold)
r="5_Homo_sapiens"
#for each unique scaffold in reference
reference.table.scaffold<-analysis.table.reference%>%filter(.,species_scaffold==r)
#find cluster_id
ref.cluster_id<-unique(reference.table.scaffold$cluster_id)
#find all unique scaffolds in comparison table with that cluster_id
comp.scaffold<-analysis.table.comparison%>%filter(.,cluster_id==ref.cluster_id)
comp.scaffold<-unique(comp.scaffold$species_scaffold)
c="1_Danio_rerio"
comp.table.scaffold<-analysis.table.comparison%>%filter(.,species_scaffold==c)
comparison_absent<-anti_join(reference.table.scaffold,comp.table.scaffold,by="homology_id")
reference="Homo_sapiens"
comparison="Danio_rerio"
#subset cluster.master.table for the reference or comparison animal:
analysis.table.reference<-filter(cluster.master.table,animal==reference)
analysis.table.comparison<-filter(cluster.master.table,animal==comparison)
#list of unique scaffold ids in reference
ref.scaffold<-unique(analysis.table.reference$species_scaffold)
#for each unique scaffold in the reference table:
for (r in ref.scaffold){
r="5_Homo_sapiens"
#for each unique scaffold in reference
reference.table.scaffold<-analysis.table.reference%>%filter(.,species_scaffold==r)
#find cluster_id
ref.cluster_id<-unique(reference.table.scaffold$cluster_id)
#find all unique scaffolds in comparison table with that cluster_id
comp.scaffold<-analysis.table.comparison%>%filter(.,cluster_id==ref.cluster_id)
comp.scaffold<-unique(comp.scaffold$species_scaffold)
#for each unique scaffold in comparison table with that cluster_id
for (c in comp.scaffold){
c="1_Danio_rerio"
comp.table.scaffold<-analysis.table.comparison%>%filter(.,species_scaffold==c)
comparison_absent<-anti_join(reference.table.scaffold,comp.table.scaffold,by="homology_id")
}
}
#works line by line but not when looping
comparison_absent<-anti_join(analysis.table.reference,analysis.table.comparison,by="homology_id")
reference="Homo_sapiens"
comparison="Danio_rerio"
#subset cluster.master.table for the reference or comparison animal:
analysis.table.reference<-filter(cluster.master.table,animal==reference)
analysis.table.comparison<-filter(cluster.master.table,animal==comparison)
#list of unique scaffold ids in reference
ref.scaffold<-unique(analysis.table.reference$species_scaffold)
#for each unique scaffold in the reference table:
for (r in ref.scaffold){
r="5_Homo_sapiens"
#for each unique scaffold in reference
reference.table.scaffold<-analysis.table.reference%>%filter(.,species_scaffold==r)
#find cluster_id
ref.cluster_id<-unique(reference.table.scaffold$cluster_id)
#find all unique scaffolds in comparison table with that cluster_id
comp.scaffold<-analysis.table.comparison%>%filter(.,cluster_id==ref.cluster_id)
comp.scaffold<-unique(comp.scaffold$species_scaffold)
#for each unique scaffold in comparison table with that cluster_id
for (c in comp.scaffold){
c="1_Danio_rerio"
comp.table.scaffold<-analysis.table.comparison%>%filter(.,species_scaffold==c)
comparison_absent<-anti_join(reference.table.scaffold,comp.table.scaffold,by="homology_id")
}
}
#works line by line but not when looping
comparison_absent<-anti_join(analysis.table.reference,analysis.table.comparison,by="homology_id")
#must run previous chunk first
#Take a subset! Otherwise following code will not complete running and freeze everything!!!
tmp<-master.table
filter_target=c("Homo_sapiens","Danio_rerio")
master.table<-filter(master.table, animal==filter_target)
#There are human gene names in pep files that are not anywhere in gff3 files = inner_join
#Scaffold names may not be unique but must be - join seqid and catalog id
final.master.table_cluster<-inner_join(master.table,agalma.homologs)%>%dplyr::select(.,seqid,start,end,gene,homology_id,catalog_id,animal)%>%mutate(species_scaffold=str_c(seqid,animal,sep="_"))%>%dplyr::select(.,species_scaffold,homology_id,gene)
#make contingency table
contingency<-table(final.master.table_cluster$species_scaffold,final.master.table_cluster$homology_id)%>%as.matrix()
contingency<-1*(contingency>0)
#dissimilarity matrix
dist.matrix<-daisy(contingency,metric="gower",stand=FALSE)
#cluster
ag<-agnes(dist.matrix,diss=TRUE)
plot(ag)
cross.clust<-cc_crossclustering(dist.matrix,out=FALSE)
clust<-cc_get_cluster(cross.clust)
#put together the scaffold:cluster dataframe
clust.df<-as.data.frame(clust)
colnames(clust.df)<-"cluster_id"
clust.df<-mutate(clust.df,species_scaffold=row.names(contingency))
#final working table
cluster.master.table<-final.master.table%>%mutate(species_scaffold=str_c(seqid,animal,sep="_"))%>%left_join(.,clust.df,by="species_scaffold")%>%select(.,species_scaffold,start,end,gene,homology_id,animal,cluster_id)
write.csv(cluster.master.table,"cluster.master.table.csv",quote=FALSE,row.names=FALSE)
sample.table<-read.table("sample.table.txt",heder=TRUE,sep=",")
sample.table<-read.table("sample.table.txt",header=TRUE,sep=",")
sample.table<-read.table("sample.table.txt",header=TRUE,sep=",")
analysis.table.reference<-filter(sample.table,animal==reference & homology_id != NA)
analysis.table.comparison<-filter(sample.table,animal==comparison & homology_id != NA)
View(analysis.table.reference)
analysis.table.reference<-filter(sample.table,animal==reference && homology_id != NA)
analysis.table.comparison<-filter(sample.table,animal==comparison && homology_id != NA)
View(analysis.table.reference)
analysis.table.reference<-filter(sample.table,animal==reference)
analysis.table.comparison<-filter(sample.table,animal==comparison)
View(analysis.table.reference)
View(comparison.table.reference)
View(analysis.table.reference)
View(analysis.table.comparison)
analysis.table.reference<-filter(sample.table,animal==reference & !is.na(homology_id))
View(analysis.table.reference)
#subset cluster.master.table for the reference or comparison animal:
#analysis.table.reference<-filter(cluster.master.table,animal==reference)
#analysis.table.comparison<-filter(cluster.master.table,animal==comparison)
sample.table<-read.table("sample.table.txt",header=TRUE,sep=",")
reference="Homo_sapiens"
comparison="Danio_rerio"
#subset cluster.master.table for the reference or comparison animal:
#analysis.table.reference<-filter(cluster.master.table,animal==reference)
#analysis.table.comparison<-filter(cluster.master.table,animal==comparison)
sample.table<-read.table("sample.table.txt",header=TRUE,sep=",")
#remove NAs
analysis.table.reference<-filter(sample.table,animal==reference & !is.na(homology_id))
analysis.table.comparison<-filter(sample.table,animal==comparison & !is.na(homology_id))
#list of unique scaffold ids in reference
ref.scaffold<-unique(analysis.table.reference$species_scaffold)
#for each unique scaffold in the reference table:
for (r in ref.scaffold){
#find cluster id for each scaffold
reference.table.scaffold<-analysis.table.reference%>%filter(.,species_scaffold==r)
ref.cluster_id<-unique(reference.table.scaffold$cluster_id)
#find all unique scaffolds in comparison table with that cluster_id
comp.scaffold<-analysis.table.comparison%>%filter(.,cluster_id==ref.cluster_id)
comp.scaffold<-unique(comp.scaffold$species_scaffold)
#for each unique scaffold in comparison table w/ cluster_id
for (c in comp.scaffold){
#isolate genes from that scaffold and compare to original ref scaffold
comp.table.scaffold<-analysis.table.comparison%>%filter(.,species_scaffold==c)
comparison_absent<-anti_join(reference.table.scaffold,comp.table.scaffold,by="homology_id")
}
}
#works line by line but not when looping
comparison_absent<-anti_join(analysis.table.reference,analysis.table.comparison,by="homology_id")
View(comparison_absent)
View(sample.table)
View(analysis.table.reference)
View(analysis.table.comparison)
reference="Homo_sapiens"
comparison="Danio_rerio"
#subset cluster.master.table for the reference or comparison animal:
#analysis.table.reference<-filter(cluster.master.table,animal==reference)
#analysis.table.comparison<-filter(cluster.master.table,animal==comparison)
sample.table<-read.table("sample.table.txt",header=TRUE,sep=",")
#remove NAs
analysis.table.reference<-filter(sample.table,animal==reference & !is.na(homology_id))
analysis.table.comparison<-filter(sample.table,animal==comparison & !is.na(homology_id))
#list of unique scaffold ids in reference
ref.scaffold<-unique(analysis.table.reference$species_scaffold)
#for each unique scaffold in the reference table:
for (r in ref.scaffold){
#find cluster id for each scaffold
reference.table.scaffold<-analysis.table.reference%>%filter(.,species_scaffold==r)
ref.cluster_id<-unique(reference.table.scaffold$cluster_id)
#find all unique scaffolds in comparison table with that cluster_id
comp.scaffold<-analysis.table.comparison%>%filter(.,cluster_id==ref.cluster_id)
comp.scaffold<-unique(comp.scaffold$species_scaffold)
#for each unique scaffold in comparison table w/ cluster_id
for (c in comp.scaffold){
#isolate genes from that scaffold and compare to original ref scaffold
comp.table.scaffold<-analysis.table.comparison%>%filter(.,species_scaffold==c)
comparison_absent<-anti_join(reference.table.scaffold,comp.table.scaffold,by="homology_id")%>%mutate(comp_scaffold=c)
}
}
#works line by line but not when looping
comparison_absent<-anti_join(analysis.table.reference,analysis.table.comparison,by="homology_id")
View(comparison_absent)
reference="Homo_sapiens"
comparison="Danio_rerio"
#subset cluster.master.table for the reference or comparison animal:
#analysis.table.reference<-filter(cluster.master.table,animal==reference)
#analysis.table.comparison<-filter(cluster.master.table,animal==comparison)
sample.table<-read.table("sample.table.txt",header=TRUE,sep=",")
#remove NAs
analysis.table.reference<-filter(sample.table,animal==reference & !is.na(homology_id))
analysis.table.comparison<-filter(sample.table,animal==comparison & !is.na(homology_id))
#list of unique scaffold ids in reference
ref.scaffold<-unique(analysis.table.reference$species_scaffold)
#for each unique scaffold in the reference table:
for (r in ref.scaffold){
#find cluster id for each scaffold
reference.table.scaffold<-analysis.table.reference%>%filter(.,species_scaffold==r)
ref.cluster_id<-unique(reference.table.scaffold$cluster_id)
#find all unique scaffolds in comparison table with that cluster_id
comp.scaffold<-analysis.table.comparison%>%filter(.,cluster_id==ref.cluster_id)
comp.scaffold<-unique(comp.scaffold$species_scaffold)
#for each unique scaffold in comparison table w/ cluster_id
for (c in comp.scaffold){
#isolate genes from that scaffold and compare to original ref scaffold
comp.table.scaffold<-analysis.table.comparison%>%filter(.,species_scaffold==c)
comparison_absent<-anti_join(reference.table.scaffold,comp.table.scaffold,by="homology_id")%>%mutate(.,comp_scaffold=c)
}
}
#works line by line but not when looping
comparison_absent<-anti_join(analysis.table.reference,analysis.table.comparison,by="homology_id")
View(comparison_absent)
reference="Homo_sapiens"
comparison="Danio_rerio"
#subset cluster.master.table for the reference or comparison animal:
#analysis.table.reference<-filter(cluster.master.table,animal==reference)
#analysis.table.comparison<-filter(cluster.master.table,animal==comparison)
sample.table<-read.table("sample.table.txt",header=TRUE,sep=",")
#remove NAs
analysis.table.reference<-filter(sample.table,animal==reference & !is.na(homology_id))
analysis.table.comparison<-filter(sample.table,animal==comparison & !is.na(homology_id))
#list of unique scaffold ids in reference
ref.scaffold<-unique(analysis.table.reference$species_scaffold)
#for each unique scaffold in the reference table:
for (r in ref.scaffold){
#find cluster id for each scaffold
reference.table.scaffold<-analysis.table.reference%>%filter(.,species_scaffold==r)
ref.cluster_id<-unique(reference.table.scaffold$cluster_id)
#find all unique scaffolds in comparison table with that cluster_id
comp.scaffold<-analysis.table.comparison%>%filter(.,cluster_id==ref.cluster_id)
comp.scaffold<-unique(comp.scaffold$species_scaffold)
#for each unique scaffold in comparison table w/ cluster_id
for (c in comp.scaffold){
#isolate genes from that scaffold and compare to original ref scaffold
comp.table.scaffold<-analysis.table.comparison%>%filter(.,species_scaffold==c)
comparison_absent<-anti_join(reference.table.scaffold,comp.table.scaffold,by="homology_id")
comparison_absent<-mutate(comparison_absent,comp_scaff=c)
}
}
#works line by line but not when looping
comparison_absent<-anti_join(analysis.table.reference,analysis.table.comparison,by="homology_id")
View(comparison_absent)
