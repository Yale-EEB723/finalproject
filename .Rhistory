#Parse out the gene_id from the attributes
all.df$gene<-gsub(".*gene_id=(.*?);.*","\\1",all.df$attributes)
#Construct gff3 table
gff3.table<-select(all.df,"seqid","start","end","gene")
#add animal IDs to gff3 table
gff3.table$animal<-c(rep.int("Amphimedon_queenslandica",43615),rep.int("Capitella_telata",32175),rep.int("Danio_rerio",25606),rep.int("Drosophila_melanogaster",13931),rep.int("Helobdella_robusta",23432),rep.int("Homo_sapiens",21492),rep.int("Lottia_gigantea",23349),rep.int("Mnemiopsis_leidyi",16559),rep.int("Nematostella_vectensis",24773),rep.int("Strongylocentrotus_purpuratus",28987),rep.int("Taeniopygia_guttata",17488),rep.int("Trichoplax_adhaerens",11520))
#~~~ GFF3 Table Finished ~~~
#Read in agalma homologs csv
agalma.homologs<-read.csv("5taxa_results_alt.csv",header=TRUE,sep=",")
#must run previous chunk prior to running this chunk
gff3.table.save<-gff3.table
#***SUBSAMPLE: choose from which animals you want to cluster scaffolds. Not doing so makes computation impossible on a local machine.
filter_target=c("Homo_sapiens","Danio_rerio")
gff3.table<-filter(gff3.table, animal==filter_target)
#~~~Create contingency.table~~~
#Make scaffold names unique- join seqid and catalog id
contingency.table<-inner_join(gff3.table,agalma.homologs)%>%dplyr::select(.,seqid,homology_id,animal)%>%mutate(species_scaffold=str_c(seqid,animal,sep="_"))%>%dplyr::select(.,species_scaffold,homology_id)
#~~~contingency.table compelte~~~
#Use contingency.table to make the contingency table
contingency<-table(contingency.table$species_scaffold,contingency.table$homology_id)%>%as.matrix()
contingency<-1*(contingency>0)
#***DOWNSAMPLE contingency table for computation on a local machine.
contingency<-contingency[sample(100),sample(100)]
#distance matrix
dist.matrix<-daisy(contingency,metric="gower",stand=FALSE)
#cluster
#cross-cluster
cross.clust<-cc_crossclustering(dist.matrix,out=FALSE)
clust<-cc_get_cluster(cross.clust)
#plot w/ tSNE
#adjust perplexity if get error "perplexity is too large for the number of samples"
tsne_obj<-Rtsne(dist.matrix,is_distance=TRUE,perplexity=1)
tsne_data<-tsne_obj$Y%>%data.frame()%>%setNames(c("X","Y"))%>%mutate(cluster=factor(clust))
tsne_plot<-ggplot(aes(x = X, y = Y), data = tsne_data) + geom_point(aes(color = cluster))
tsne_plot
#agglomerative
ag<-agnes(dist.matrix,diss=TRUE)
plot(ag,labels=FALSE)
#divisive
di<-diana(dist.matrix)
plot(di,labels=FALSE)
#kmeans
dist.matrix.coerced<-as.matrix(dist.matrix)
fviz_nbclust(dist.matrix.coerced,kmeans,method="wss")
kmean<-kmeans(dist.matrix,2)
kclust<-kmean$cluster
tsne_obj<-Rtsne(dist.matrix,is_distance=TRUE,perplexity=1)
tsne_data<-tsne_obj$Y%>%data.frame()%>%setNames(c("X","Y"))%>%mutate(cluster=factor(kclust))
tsn_plot_k<-ggplot(aes(x = X, y = Y), data = tsne_data) + geom_point(aes(color = cluster))
tsn_plot_k
#~~~Clustering complete~~~
#~~~Create master.table.~~~
#Put together a scaffold:cluster df
clust.df<-as.data.frame(clust)
colnames(clust.df)<-"cluster_id"
clust.df<-mutate(clust.df,species_scaffold=row.names(contingency))
master.table<-left_join(gff3.table.save,agalma.homologs)%>%select(.,"seqid","start","end","gene","homology_id","catalog_id","animal")%>%mutate(species_scaffold=str_c(seqid,animal,sep="_"))%>%left_join(.,clust.df,by="species_scaffold")%>%select(.,species_scaffold,start,end,gene,homology_id,animal,cluster_id)
knitr::opts_chunk$set(
message = FALSE,
warning = FALSE,
echo=FALSE,
dpi=300,
cache=TRUE
)
library( tidyverse )
library(ggplot2)
library(seqinr)
library(ape)
library(Biostrings)
library(dplyr)
#clustering
library(cluster)
library(CrossClustering)
library(vegan)
library(Rtsne)
library(factoextra)
#tree manipulation
library(ape)
library(hutan)
fasta_dir<-"~/Desktop/compgen/repo/ensembl/genome_fasta/"
fasta<-c("Amphimedon_queenslandica.Aqu1.dna.toplevel.fa","Capitella_teleta.Capitella_teleta_v1.0.dna.toplevel.fa","Drosophila_chr.fa", "Helobdella_robusta.Helro1.dna.toplevel.fa","Lottia_gigantea.Lotgi1.dna.toplevel.fa","Mnemiopsis_leidyi.MneLei_Aug2011.dna.toplevel.fa","Nematostella_vectensis.ASM20922v1.dna.toplevel.fa","Strongylocentrotus_purpuratus.Spur_3.1.dna.toplevel.fa","Taeniopygia_guttata.taeGut3.2.4.dna.toplevel.fa","Trichoplax_adhaerens.ASM15027v1.dna.toplevel.fa")
for (blah in fasta){
fasta_path<-paste0(fasta_dir,blah)
#histogram of call ontig lengths,
scaffold.length.plot<-read.fasta(fasta_path)%>%getLength(.)%>%as.data.frame()%>%ggplot()+geom_histogram(aes(x=.), fill="skyblue3", color="black",binwidth=100)+xlab("Scaffold Length")+labs(title=blah)
scaffold.length.plot
ggsave(scaffold,length.plot,file=paste0("scaffold.len_",blah,".pdf"))
#histogram of contig lengths, restricted to scaffolds < 10,000 bp
#restricted.plot<-read.fasta(fasta_path)%>%getLength(.)%>%as.data.frame()%>%filter(.<10000)%>%ggplot()+geom_histogram(aes(x=.), fill="skyblue3", color="black",binwidth=100)+xlab("Scaffold Length")+labs(title=blah)
#restricted.plot
#stats
fasta.len=read.fasta(fasta_path)%>%getLength()
print(paste("Median scaffold/contig length (bp):",median(as.numeric(fasta.len))))
print(paste("Max scaffold/contig length (bp):",max(as.numeric(fasta.len))))
print(paste("Minimum scaffold/contig length (bp):",min(as.numeric(fasta.len))))
}
fasta_dir<-"~/Desktop/compgen/repo/ensembl/genome_fasta/"
fasta<-c("Amphimedon_queenslandica.Aqu1.dna.toplevel.fa","Capitella_teleta.Capitella_teleta_v1.0.dna.toplevel.fa","Drosophila_chr.fa", "Helobdella_robusta.Helro1.dna.toplevel.fa","Lottia_gigantea.Lotgi1.dna.toplevel.fa","Mnemiopsis_leidyi.MneLei_Aug2011.dna.toplevel.fa","Nematostella_vectensis.ASM20922v1.dna.toplevel.fa","Strongylocentrotus_purpuratus.Spur_3.1.dna.toplevel.fa","Taeniopygia_guttata.taeGut3.2.4.dna.toplevel.fa","Trichoplax_adhaerens.ASM15027v1.dna.toplevel.fa")
for (blah in fasta){
fasta_path<-paste0(fasta_dir,blah)
#histogram of call ontig lengths,
scaffold.length.plot<-read.fasta(fasta_path)%>%getLength(.)%>%as.data.frame()%>%ggplot()+geom_histogram(aes(x=.), fill="skyblue3", color="black",binwidth=100)+xlab("Scaffold Length")+labs(title=blah)
scaffold.length.plot
ggsave(scaffold.length.plot,file=paste0("scaffold.len_",blah,".pdf"))
#histogram of contig lengths, restricted to scaffolds < 10,000 bp
#restricted.plot<-read.fasta(fasta_path)%>%getLength(.)%>%as.data.frame()%>%filter(.<10000)%>%ggplot()+geom_histogram(aes(x=.), fill="skyblue3", color="black",binwidth=100)+xlab("Scaffold Length")+labs(title=blah)
#restricted.plot
#stats
fasta.len=read.fasta(fasta_path)%>%getLength()
print(paste("Median scaffold/contig length (bp):",median(as.numeric(fasta.len))))
print(paste("Max scaffold/contig length (bp):",max(as.numeric(fasta.len))))
print(paste("Minimum scaffold/contig length (bp):",min(as.numeric(fasta.len))))
}
fasta_dir<-"~/Desktop/compgen/repo/ensembl/genome_fasta/"
fasta<-c("Amphimedon_queenslandica.Aqu1.dna.toplevel.fa","Capitella_teleta.Capitella_teleta_v1.0.dna.toplevel.fa","Drosophila_chr.fa", "Helobdella_robusta.Helro1.dna.toplevel.fa","Lottia_gigantea.Lotgi1.dna.toplevel.fa","Mnemiopsis_leidyi.MneLei_Aug2011.dna.toplevel.fa","Nematostella_vectensis.ASM20922v1.dna.toplevel.fa","Strongylocentrotus_purpuratus.Spur_3.1.dna.toplevel.fa","Taeniopygia_guttata.taeGut3.2.4.dna.toplevel.fa","Trichoplax_adhaerens.ASM15027v1.dna.toplevel.fa")
for (blah in fasta){
fasta_path<-paste0(fasta_dir,blah)
#histogram of call ontig lengths,
scaffold.length.plot<-read.fasta(fasta_path)%>%getLength(.)%>%as.data.frame()%>%ggplot()+geom_histogram(aes(x=.), fill="skyblue3", color="black",binwidth=100)+xlab("Scaffold Length")+labs(title=blah)
scaffold.length.plot
ggsave(scaffold.length.plot,file=paste0("scaffold.len_",blah,".pdf"))
#histogram of contig lengths, restricted to scaffolds < 10,000 bp
restricted.plot<-read.fasta(fasta_path)%>%getLength(.)%>%as.data.frame()%>%filter(.<10000)%>%ggplot()+geom_histogram(aes(x=.), fill="skyblue3", color="black",binwidth=100)+xlab("Scaffold Length")+labs(title=blah)
restricted.plot
ggsave(scaffold.length.plot,file=paste0("scaffold.len_10000bp_",blah,".pdf"))
#stats
print(blah)
fasta.len=read.fasta(fasta_path)%>%getLength()
print(paste("Median scaffold/contig length (bp):",median(as.numeric(fasta.len))))
print(paste("Max scaffold/contig length (bp):",max(as.numeric(fasta.len))))
print(paste("Minimum scaffold/contig length (bp):",min(as.numeric(fasta.len))))
}
fasta_dir<-"~/Desktop/compgen/repo/ensembl/genome_fasta/"
fasta<-c("Amphimedon_queenslandica.Aqu1.dna.toplevel.fa","Capitella_teleta.Capitella_teleta_v1.0.dna.toplevel.fa","Drosophila_chr.fa", "Helobdella_robusta.Helro1.dna.toplevel.fa","Lottia_gigantea.Lotgi1.dna.toplevel.fa","Mnemiopsis_leidyi.MneLei_Aug2011.dna.toplevel.fa","Nematostella_vectensis.ASM20922v1.dna.toplevel.fa","Strongylocentrotus_purpuratus.Spur_3.1.dna.toplevel.fa","Taeniopygia_guttata.taeGut3.2.4.dna.toplevel.fa","Trichoplax_adhaerens.ASM15027v1.dna.toplevel.fa")
for (blah in fasta){
fasta_path<-paste0(fasta_dir,blah)
#histogram of call ontig lengths,
scaffold.length.plot<-read.fasta(fasta_path)%>%getLength(.)%>%as.data.frame()%>%ggplot()+geom_histogram(aes(x=.), fill="skyblue3", color="black",binwidth=100)+xlab("Scaffold Length")+labs(title=blah)
scaffold.length.plot
ggsave(scaffold.length.plot,file=paste0("scaffold.len_",blah,".pdf"))
#histogram of contig lengths, restricted to scaffolds < 10,000 bp
restricted.plot<-read.fasta(fasta_path)%>%getLength(.)%>%as.data.frame()%>%filter(.<10000)%>%ggplot()+geom_histogram(aes(x=.), fill="skyblue3", color="black",binwidth=100)+xlab("Scaffold Length")+labs(title=blah)
restricted.plot
ggsave(scaffold.length.plot,file=paste0("scaffold.len_10000bp_",blah,".pdf"))
#stats
print(blah)
fasta.len=read.fasta(fasta_path)%>%getLength()
print(paste("Median scaffold/contig length (bp):",median(as.numeric(fasta.len))))
print(paste("Max scaffold/contig length (bp):",max(as.numeric(fasta.len))))
print(paste("Minimum scaffold/contig length (bp):",min(as.numeric(fasta.len))))
}
scaffold.length.plot
scaffold.length.plot<-read.fasta(fasta_path)%>%getLength(.)%>%as.data.frame()%>%ggplot()+geom_histogram(aes(x=.), fill="skyblue3", color="black",binwidth=100)+xlab("Scaffold Length")+labs(title=blah)+theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"))
scaffold.length.plot<-read.fasta(fasta_path)%>%getLength(.)%>%as.data.frame()%>%ggplot()+geom_histogram(aes(x=.), fill="skyblue3", color="black",binwidth=100)+xlab("Scaffold Length")+ylab("Frequency")+labs(title=blah)
#install.packages("ape")
gff3_dir<-"data/genomes/gff3/"
gff3<-c("Amphimedon_queenslandica.Aqu1.42.gff3","Capitella_teleta.Capitella_teleta_v1.0.42.gff3","Danio_rerio.GRCz11.96.chr.gff3","Drosophila_melanogaster.BDGP6.22.96.chr.gff3","Helobdella_robusta.Helro1.42.gff3","Homo_sapiens.GRCh38.96.chr.gff3","Lottia_gigantea.Lotgi1.42.gff3","Mnemiopsis_leidyi.MneLei_Aug2011.42.gff3","Nematostella_vectensis.ASM20922v1.42.gff3","Strongylocentrotus_purpuratus.Spur_3.1.42.gff3","Taeniopygia_guttata.taeGut3.2.4.96.chr.gff3","Trichoplax_adhaerens.ASM15027v1.42.gff3")
for (blah in gff3){
gff3_path<-paste0(gff3_dir,blah)
contig.gene.df <- ape::read.gff(file=gff3_path, GFF3=TRUE) %>% select(.,"seqid","type","start","end") %>% filter(.,type == "gene")
#for histogram, take just the contig names and gene counts
gene.count<- as.data.frame(table(contig.gene.df$seqid))
#plot frequency of frequencies
gff3.plot<-ggplot(data = gene.count, aes(x=gene.count$Freq)) + geom_histogram(binwidth=1) + geom_vline(xintercept = 3,color="red")+ggtitle(blah)
gff3.plot
#use for custom axes
#gff3.plot<-ggplot(data = gene.count, aes(x=gene.count$Freq)) + geom_histogram(binwidth=1) + geom_vline(xintercept = 3,color="red") +xlim(0,10)+ylim(0,3000)
ggsave(gff3.plot,file=paste0("gff3_",blah,".pdf"))
#stats
print(blah)
print(paste("proportion contigs with gene count >= 3:",nrow(subset(gene.count, gene.count$Freq >= 3))/nrow(gene.count)*100))
print(paste("Median no. genes/contig:",median(gene.count$Freq)))
print(paste("Max no. genes/contig:",max(gene.count$Freq)))
}
#install.packages("ape")
gff3_dir<-"data/genomes/gff3/"
gff3<-c("Amphimedon_queenslandica.Aqu1.42.gff3","Capitella_teleta.Capitella_teleta_v1.0.42.gff3","Danio_rerio.GRCz11.96.chr.gff3","Drosophila_melanogaster.BDGP6.22.96.chr.gff3","Helobdella_robusta.Helro1.42.gff3","Homo_sapiens.GRCh38.96.chr.gff3","Lottia_gigantea.Lotgi1.42.gff3","Mnemiopsis_leidyi.MneLei_Aug2011.42.gff3","Nematostella_vectensis.ASM20922v1.42.gff3","Strongylocentrotus_purpuratus.Spur_3.1.42.gff3","Taeniopygia_guttata.taeGut3.2.4.96.chr.gff3","Trichoplax_adhaerens.ASM15027v1.42.gff3")
for (blah in gff3){
gff3_path<-paste0(gff3_dir,blah)
contig.gene.df <- ape::read.gff(file=gff3_path, GFF3=TRUE) %>% select(.,"seqid","type","start","end") %>% filter(.,type == "gene")
#for histogram, take just the contig names and gene counts
gene.count<- as.data.frame(table(contig.gene.df$seqid))
#plot frequency of frequencies
gff3.plot<-ggplot(data = gene.count, aes(x=gene.count$Freq)) + geom_histogram(binwidth=1) + geom_vline(xintercept = 3,color="red")+ggtitle(blah)
gff3.plot
#use for custom axes
#gff3.plot<-ggplot(data = gene.count, aes(x=gene.count$Freq)) + geom_histogram(binwidth=1) + geom_vline(xintercept = 3,color="red") +xlim(0,10)+ylim(0,3000)
ggsave(gff3.plot,file=paste0("gff3_",blah,".pdf"))
#stats
print(blah)
print(paste("proportion contigs with gene count >= 3:",nrow(subset(gene.count, gene.count$Freq >= 3))/nrow(gene.count)*100))
print(paste("Median no. genes/contig:",median(gene.count$Freq)))
print(paste("Max no. genes/contig:",max(gene.count$Freq)))
}
#install.packages("ape")
gff3_dir<-"data/genomes/gff3/"
gff3<-c("Amphimedon_queenslandica.Aqu1.42.gff3","Capitella_teleta.Capitella_teleta_v1.0.42.gff3","Danio_rerio.GRCz11.96.chr.gff3","Drosophila_melanogaster.BDGP6.22.96.chr.gff3","Helobdella_robusta.Helro1.42.gff3","Homo_sapiens.GRCh38.96.chr.gff3","Lottia_gigantea.Lotgi1.42.gff3","Mnemiopsis_leidyi.MneLei_Aug2011.42.gff3","Nematostella_vectensis.ASM20922v1.42.gff3","Strongylocentrotus_purpuratus.Spur_3.1.42.gff3","Taeniopygia_guttata.taeGut3.2.4.96.chr.gff3","Trichoplax_adhaerens.ASM15027v1.42.gff3")
for (blah in gff3){
gff3_path<-paste0(gff3_dir,blah)
contig.gene.df <- ape::read.gff(file=gff3_path, GFF3=TRUE) %>% select(.,"seqid","type","start","end") %>% filter(.,type == "gene")
#for histogram, take just the contig names and gene counts
gene.count<- as.data.frame(table(contig.gene.df$seqid))
#plot frequency of frequencies
gff3.plot<-ggplot(data = gene.count, aes(x=gene.count$Freq)) + geom_histogram(binwidth=1) + geom_vline(xintercept = 3,color="red")+ggtitle(blah) +xlab("Number of Genes Per Contig")+ylab(Frequency)+labs(title=blah)
gff3.plot
#use for custom axes
#gff3.plot<-ggplot(data = gene.count, aes(x=gene.count$Freq)) + geom_histogram(binwidth=1) + geom_vline(xintercept = 3,color="red") +xlim(0,10)+ylim(0,3000)
ggsave(gff3.plot,file=paste0("gff3_",blah,".pdf"))
#stats
print(blah)
print(paste("proportion contigs with gene count >= 3:",nrow(subset(gene.count, gene.count$Freq >= 3))/nrow(gene.count)*100))
print(paste("Median no. genes/contig:",median(gene.count$Freq)))
print(paste("Max no. genes/contig:",max(gene.count$Freq)))
}
#install.packages("ape")
gff3_dir<-"data/genomes/gff3/"
gff3<-c("Amphimedon_queenslandica.Aqu1.42.gff3","Capitella_teleta.Capitella_teleta_v1.0.42.gff3","Danio_rerio.GRCz11.96.chr.gff3","Drosophila_melanogaster.BDGP6.22.96.chr.gff3","Helobdella_robusta.Helro1.42.gff3","Homo_sapiens.GRCh38.96.chr.gff3","Lottia_gigantea.Lotgi1.42.gff3","Mnemiopsis_leidyi.MneLei_Aug2011.42.gff3","Nematostella_vectensis.ASM20922v1.42.gff3","Strongylocentrotus_purpuratus.Spur_3.1.42.gff3","Taeniopygia_guttata.taeGut3.2.4.96.chr.gff3","Trichoplax_adhaerens.ASM15027v1.42.gff3")
for (blah in gff3){
gff3_path<-paste0(gff3_dir,blah)
contig.gene.df <- ape::read.gff(file=gff3_path, GFF3=TRUE) %>% select(.,"seqid","type","start","end") %>% filter(.,type == "gene")
#for histogram, take just the contig names and gene counts
gene.count<- as.data.frame(table(contig.gene.df$seqid))
#plot frequency of frequencies
gff3.plot<-ggplot(data = gene.count, aes(x=gene.count$Freq)) + geom_histogram(binwidth=1) + geom_vline(xintercept = 3,color="red")+ggtitle(blah) +xlab("Number of Genes Per Contig")+ylab("Frequency")+labs(title=blah)
gff3.plot
#use for custom axes
#gff3.plot<-ggplot(data = gene.count, aes(x=gene.count$Freq)) + geom_histogram(binwidth=1) + geom_vline(xintercept = 3,color="red") +xlim(0,10)+ylim(0,3000)
ggsave(gff3.plot,file=paste0("gff3_",blah,".pdf"))
#stats
print(blah)
print(paste("proportion contigs with gene count >= 3:",nrow(subset(gene.count, gene.count$Freq >= 3))/nrow(gene.count)*100))
print(paste("Median no. genes/contig:",median(gene.count$Freq)))
print(paste("Max no. genes/contig:",max(gene.count$Freq)))
}
#install.packages("ape")
gff3_dir<-"data/genomes/gff3/"
gff3<-c("Amphimedon_queenslandica.Aqu1.42.gff3","Capitella_teleta.Capitella_teleta_v1.0.42.gff3","Danio_rerio.GRCz11.96.chr.gff3","Drosophila_melanogaster.BDGP6.22.96.chr.gff3","Helobdella_robusta.Helro1.42.gff3","Homo_sapiens.GRCh38.96.chr.gff3","Lottia_gigantea.Lotgi1.42.gff3","Mnemiopsis_leidyi.MneLei_Aug2011.42.gff3","Nematostella_vectensis.ASM20922v1.42.gff3","Strongylocentrotus_purpuratus.Spur_3.1.42.gff3","Taeniopygia_guttata.taeGut3.2.4.96.chr.gff3","Trichoplax_adhaerens.ASM15027v1.42.gff3")
for (blah in gff3){
gff3_path<-paste0(gff3_dir,blah)
contig.gene.df <- ape::read.gff(file=gff3_path, GFF3=TRUE) %>% select(.,"seqid","type","start","end") %>% filter(.,type == "gene")
#for histogram, take just the contig names and gene counts
gene.count<- as.data.frame(table(contig.gene.df$seqid))
#plot frequency of frequencies
gff3.plot<-ggplot(data = gene.count, aes(x=gene.count$Freq)) + geom_histogram(binwidth=1) + geom_vline(xintercept = 3,color="red")+ggtitle(blah) +xlab("Number of Genes Per Contig")+ylab("Frequency")+labs(title=blah)
gff3.plot
ggsave(gff3.plot,file=paste0("gff3_",blah,".pdf"))
#use for custom axes
gff3.plot.custom.axes<-ggplot(data = gene.count, aes(x=gene.count$Freq)) + geom_histogram(binwidth=1) + geom_vline(xintercept = 3,color="red") +xlim(0,10)+ylim(0,3000)+xlab("Number of Genes Per Contig")+ylab("Frequency")+labs(title=blah)
gff3.plot.custom.axes<
ggsave(gff3.plot,file=paste0("gff3_customaxes_",blah,".pdf"))
#stats
print(blah)
print(paste("proportion contigs with gene count >= 3:",nrow(subset(gene.count, gene.count$Freq >= 3))/nrow(gene.count)*100))
print(paste("Median no. genes/contig:",median(gene.count$Freq)))
print(paste("Max no. genes/contig:",max(gene.count$Freq)))
}
#install.packages("ape")
gff3_dir<-"data/genomes/gff3/"
gff3<-c("Amphimedon_queenslandica.Aqu1.42.gff3","Capitella_teleta.Capitella_teleta_v1.0.42.gff3","Danio_rerio.GRCz11.96.chr.gff3","Drosophila_melanogaster.BDGP6.22.96.chr.gff3","Helobdella_robusta.Helro1.42.gff3","Homo_sapiens.GRCh38.96.chr.gff3","Lottia_gigantea.Lotgi1.42.gff3","Mnemiopsis_leidyi.MneLei_Aug2011.42.gff3","Nematostella_vectensis.ASM20922v1.42.gff3","Strongylocentrotus_purpuratus.Spur_3.1.42.gff3","Taeniopygia_guttata.taeGut3.2.4.96.chr.gff3","Trichoplax_adhaerens.ASM15027v1.42.gff3")
for (blah in gff3){
gff3_path<-paste0(gff3_dir,blah)
contig.gene.df <- ape::read.gff(file=gff3_path, GFF3=TRUE) %>% select(.,"seqid","type","start","end") %>% filter(.,type == "gene")
#for histogram, take just the contig names and gene counts
gene.count<- as.data.frame(table(contig.gene.df$seqid))
#plot frequency of frequencies
gff3.plot<-ggplot(data = gene.count, aes(x=gene.count$Freq)) + geom_histogram(binwidth=1) + geom_vline(xintercept = 3,color="red")+ggtitle(blah) +xlab("Number of Genes Per Contig")+ylab("Frequency")+labs(title=blah)
gff3.plot
ggsave(gff3.plot,file=paste0("gff3_",blah,".pdf"))
#use for custom axes
gff3.plot.custom.axes<-ggplot(data = gene.count, aes(x=gene.count$Freq)) + geom_histogram(binwidth=1) + geom_vline(xintercept = 3,color="red") +xlim(0,10)+ylim(0,3000)+xlab("Number of Genes Per Contig")+ylab("Frequency")+labs(title=blah)
gff3.plot.custom.axes<
ggsave(gff3.plot.custom.axes,file=paste0("gff3_customaxes_",blah,".pdf"))
#stats
print(blah)
print(paste("proportion contigs with gene count >= 3:",nrow(subset(gene.count, gene.count$Freq >= 3))/nrow(gene.count)*100))
print(paste("Median no. genes/contig:",median(gene.count$Freq)))
print(paste("Max no. genes/contig:",max(gene.count$Freq)))
}
fasta_dir<-"~/Desktop/compgen/repo/ensembl/genome_fasta/"
fasta<-c("Amphimedon_queenslandica.Aqu1.dna.toplevel.fa","Capitella_teleta.Capitella_teleta_v1.0.dna.toplevel.fa","Drosophila_chr.fa", "Helobdella_robusta.Helro1.dna.toplevel.fa","Lottia_gigantea.Lotgi1.dna.toplevel.fa","Mnemiopsis_leidyi.MneLei_Aug2011.dna.toplevel.fa","Nematostella_vectensis.ASM20922v1.dna.toplevel.fa","Strongylocentrotus_purpuratus.Spur_3.1.dna.toplevel.fa","Taeniopygia_guttata.taeGut3.2.4.dna.toplevel.fa","Trichoplax_adhaerens.ASM15027v1.dna.toplevel.fa")
read,table<-("genome_data.csv",header=TRUE)
read.csv<-("genome_data.csv",header=TRUE)
read.csv<-(genome_data.csv,header=TRUE)
read.csv<-("genome_data.csv",header=TRUE)
read.csv<-(file="genome_data.csv",header=TRUE)
read.csv<-(file="genome_data.csv",header=TRUE,sep=",")
read.csv(file="genome_data.csv",header=TRUE,sep=",")
csv<-read.csv(file="genome_data.csv",header=TRUE,sep=",")
data.frame(y=csv$median_scaff_len)
df<-data.frame(y=csv$median_scaff_len)
df<-mutate(df,x=c(1,2,3,4,5,6,7,8,9,10,11,12))
df<-mutate(df,x=c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))
View(df)
ggplot(df,aes(x=x,y=y))+geom_col(fill="skyblue3")+scale_y_continuous(trans='log10')
#median scaffold length
csv<-read.csv("genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df<-mutate(df,x=c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))%>%factor()
ggplot(df,aes(x=x,y=y))+geom_col(fill="skyblue3")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("")
#median scaffold length
csv<-read.csv("genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-factor(x=c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))%>%factor()
ggplot(df,aes(x=x,y=y))+geom_col(fill="skyblue3")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("")
#median scaffold length
csv<-read.csv("genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-factor(x=c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))%>%factor()
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_col(fill="skyblue3")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("")
ggplot_median.scaffold.len
#median scaffold length
csv<-read.csv("genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-factor(x=c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))%>%factor()
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_col(fill="skyblue3")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
ggplot_median.scaffold.len
#median scaffold length
csv<-read.csv(output/"genome_data.csv")
#median scaffold length
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-factor(x=c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))%>%factor()
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_col(fill="skyblue3")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
df<-data.frame(y=csv$no.chromosomes)
ggplot_no.scaff<-ggplot(df,aes(x=x,y=y))+geom_col(fill="skyblue3")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Number of Scaffolds")+labs(title = "Number of Scaffolds per Genome Assembly")
ggplot_no.scaff
df<-data.frame(y=csv$no.chromosomes)
ggplot_no_scaff<-ggplot(df,aes(x=x,y=y))+geom_col(fill="skyblue3")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Number of Scaffolds")+labs(title = "Number of Scaffolds per Genome Assembly")
ggplot_no_scaff
df<-data.frame(y=csv$no.chromosomes)
df$x<-factor(x=c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))%>%factor()
ggplot_no_scaff<-ggplot(df,aes(x=x,y=y))+geom_col(fill="skyblue3")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Number of Scaffolds")+labs(title = "Number of Scaffolds per Genome Assembly")
ggplot_no_scaff
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-factor(x=c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))%>%factor()
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_col(fill="skyblue3")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
ggplot_median.scaffold.len
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
x<-factor(x=c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))%>%factor()
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_col(fill="skyblue3")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
ggplot_median.scaffold.len
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
x<-factor(x=c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_col(fill="skyblue3")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
ggplot_median.scaffold.len
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-factor(df$x,levels=c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_col(fill="skyblue3")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
ggplot_median.scaffold.len
df$x<-factor(df$x,levels=c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))
View(df)
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-""
df$x<-factor(df$x,levels=c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_col(fill="skyblue3")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
View(ggplot_median.scaffold.len)
ggplot_median.scaffold.len
View(df)
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<
df$x<-factor(df$x,levels=c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_col(fill="skyblue3",stat="identity")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
df<-data.frame(y=csv$median_scaff_len)
df$x<-factor(df$x,levels=c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_col(fill="skyblue3")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
df$x
factor(df$x,levels=c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))
df$x<-factor(df$x,levels=c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))
csv<-read.csv("output/genome_data.csv")
df<-data.frame(x=factor(df$x,levels=c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu")))
df$y<-csv$median_scaff_len
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_col(fill="skyblue3")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-as.factor(df$x,levels=c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_col(fill="skyblue3")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-as.factor(c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_col(fill="skyblue3")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
ggplot_median.scaffold.len
df$x
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-as.factor(c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_bar(fill="skyblue3",stat="identity")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
ggplot_median.scaffold.len
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-factor(df$x, levels=df$x[order(c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))])
df$x
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu")
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_bar(fill="skyblue3",stat="identity")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
ggplot_median.scaffold.len
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu")
df$y<-reorder(df$y,df$x)
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_bar(fill="skyblue3",stat="identity")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
ggplot_median.scaffold.len
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu")
df$x<-reorder(df$y,df$x)
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_bar(fill="skyblue3",stat="identity")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
ggplot_median.scaffold.len
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu")
df$x<-reorder(df$x,df$x)
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_bar(fill="skyblue3",stat="identity")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
ggplot_median.scaffold.len
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-factor(df$x,c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_bar(fill="skyblue3",stat="identity")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-factor(df$x,as.character(c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_bar(fill="skyblue3",stat="identity")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-factor(df$x,as.character("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu")
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_bar(fill="skyblue3",stat="identity")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-factor(df$x,as.character("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu")
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_bar(fill="skyblue3",stat="identity")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
species<-"Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-factor(df$x,as.character(species)
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_bar(fill="skyblue3",stat="identity")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
species<-"Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-factor(df$x,as.character(species))
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_bar(fill="skyblue3",stat="identity")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
species<-c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu")
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-factor(df$x,as.character(species))
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_bar(fill="skyblue3",stat="identity")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
species<-c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu")
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-species
df$x<-as.character(df$x)
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_bar(fill="skyblue3",stat="identity")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
ggplot_median.scaffold.len
species<-c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu")
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-as.character(df$species)
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_bar(fill="skyblue3",stat="identity")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
species<-c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu")
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-df$species
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_bar(fill="skyblue3",stat="identity")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
ggplot_median.scaffold.len
species<-c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu")
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-df$species
ggplot_median.scaffold.len<-ggplot(df,aes(x=as/factor(x),y=y))+geom_bar(fill="skyblue3",stat="identity")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
ggplot_median.scaffold.len
#median scaffold length
species<-c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu")
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-df$species
ggplot_median.scaffold.len<-ggplot(df,aes(x=as.factor(x),y=y))+geom_bar(fill="skyblue3",stat="identity")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
ggplot_median.scaffold.len
species<-c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu")
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-fct_reorder(y,species)
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_bar(fill="skyblue3",stat="identity")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
species<-c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu")
csv<-read.csv("output/genome_data.csv")
df$y<-data.frame(y=csv$median_scaff_len)
df$x<-fct_reorder(y,species)
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_bar(fill="skyblue3",stat="identity")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
species<-c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu")
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-factor(df.$x,levels=c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))
df$x<-fct_reorder(y,species)
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_bar(fill="skyblue3",stat="identity")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
species<-c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu")
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df$x<-factor(df.$x,levels=c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))
df$x<-fct_reorder(x,y)
ggplot_median.scaffold.len<-ggplot(df,aes(x=x,y=y))+geom_bar(fill="skyblue3",stat="identity")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df<-mutate(df,x=c(1,2,3,4,5,6,7,8,9,10,11,12))
ggplot(df,aes(x=x,y=y))+geom_col(fill="skyblue3")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
csv<-read.csv("output/genome_data.csv")
df<-data.frame(y=csv$median_scaff_len)
df<-mutate(df,x=c("Mle","Aqu","Tad","Nve","Lgi","Cte","Hro","Dme","Spur","Dre","Hsa","Tgu"))
ggplot(df,aes(x=x,y=y))+geom_col(fill="skyblue3")+scale_y_continuous(trans='log10')+xlab("Species")+ylab("Log10 Median Scaffold Length (bp)")+labs(title = "Median Scaffold Length")
